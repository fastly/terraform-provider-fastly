---
layout: "fastly"
page_title: "Fastly: ngwaf_account_rule"
sidebar_current: "docs-fastly-resource-ngwaf-account-rule"
description: |-
  Provides a Fastly Next-Gen WAF Account Rule
---

# ngwaf_account_rule

Provides a Fastly Next-Gen WAF Account Rule.  
Account-level rules apply across one or more workspaces and are useful for defining shared or global WAF logic.

## Example Usage

Basic usage:

```terraform
resource "fastly_ngwaf_account_rule" "example" {
  applies_to       = ["*"]
  type             = "request"
  description      = "example"
  enabled          = true
  request_logging  = "sampled"
  group_operator   = "all"

  action {
    type = "block"
  }

  condition {
    field    = "ip"
    operator = "equals"
    value    = "1.2.3.4"
  }

  group_condition {
    group_operator = "all"

    condition {
      field    = "method"
      operator = "equals"
      value    = "POST"
    }
  }
}
```

## Import

Fastly Next-Gen WAF account rules can be imported using just the rule ID, e.g.:

```sh
$ terraform import fastly_ngwaf_account_rule.demo <ruleID>
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `action` (Block List, Min: 1) List of actions to perform when the rule matches. (see [below for nested schema](#nestedblock--action))
- `applies_to` (List of String) The list of workspace IDs or wildcard `*` this account-level rule applies to.
- `description` (String) A human-readable description of the rule.
- `enabled` (Boolean) Whether the rule is currently enabled.
- `type` (String) The type of the rule (`request` or `signal`).

### Optional

- `condition` (Block List) Flat list of individual conditions. Each must include `field`, `operator`, and `value`. (see [below for nested schema](#nestedblock--condition))
- `group_condition` (Block List) List of grouped conditions with nested logic. Each group must define a `group_operator` and at least one condition. (see [below for nested schema](#nestedblock--group_condition))
- `group_operator` (String) Logical operator to apply to group conditions (`any` or `all`).
- `request_logging` (String) Logging behavior for matching requests (`sampled` or `none`).

### Read-Only

- `id` (String) The ID of this resource.

<a id="nestedblock--action"></a>
### Nested Schema for `action`

Required:

- `type` (String) The action type, e.g. `block`, `redirect`, `exclude_signal`.

Optional:

- `signal` (String) Signal name to exclude (used when `type = exclude_signal`).


<a id="nestedblock--condition"></a>
### Nested Schema for `condition`

Required:

- `field` (String) Field to inspect (e.g., `ip`, `path`).
- `operator` (String) Operator to apply (e.g., `equals`, `contains`).
- `value` (String) The value to test the field against.


<a id="nestedblock--group_condition"></a>
### Nested Schema for `group_condition`

Required:

- `condition` (Block List, Min: 1) A list of nested conditions in this group. (see [below for nested schema](#nestedblock--group_condition--condition))
- `group_operator` (String) Logical operator for the group (`any` or `all`).

<a id="nestedblock--group_condition--condition"></a>
### Nested Schema for `group_condition.condition`

Required:

- `field` (String) Field to inspect (e.g., `ip`, `path`).
- `operator` (String) Operator to apply (e.g., `equals`, `contains`).
- `value` (String) The value to test the field against.
